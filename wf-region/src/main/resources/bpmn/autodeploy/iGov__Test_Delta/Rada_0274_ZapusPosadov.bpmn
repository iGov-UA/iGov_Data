<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://www.activiti.org/test">
  <process id="Rada_0274_ZapusPosadov" name="Запис на прийом до посадовця " isExecutable="true">
    <documentation>переменные из атрибутов sNameOrgan, sMailClerk226, sPhoneOrgan, sAddress, sPosada, sRozkladPriyom</documentation>
    <startEvent id="startevent1" name="Start">
      <extensionElements>
        <activiti:formProperty id="sID_Public_SubjectOrganJoin" name="Оберіть орган, до посадовців якого Ви бажаєте записатись на прийом" type="select" default="0" required="true"></activiti:formProperty>
        
        <activiti:formProperty id="markersLine_1" name="Інформація про заявника" type="markers" default="{&quot;attributes&quot;:{&quot;Line_1&quot;:{&quot;aElement_ID&quot;:[&quot;bankIdlastName&quot;],&quot;sValue&quot;:&quot;Інформація про заявника&quot;}}}"></activiti:formProperty>
        <activiti:formProperty id="bankIdlastName" name="Прізвище заявника" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="bankIdfirstName" name="Ім'я заявника" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="bankIdmiddleName" name="По батькові заявника" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="bankIdinn" name="IПН заявника" type="string" required="true"></activiti:formProperty>
        
        <activiti:formProperty id="tPassport" name="Паспорт заявника; (серія, номер, дата і орган, що його видав)" type="textArea" default="паспорт " required="true"></activiti:formProperty>
        <activiti:formProperty id="bankIdPassport" name="Паспортні дані ; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="phone" name="Контактний телефон" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="email" name="E-Mail адреса для зворотнього зв'язку" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="bankIdphone" name="БанкІДтелефон; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="bankIdemail" name="БанкІДпошта; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="FlagBankId" name="FlagBankIdPhoneEmail; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="markerBankIdPasportPhoneEmail" name="markerBankIdPasportPhoneEmail" type="markers" default="${markerService.loadFromFile('1_Standart_marker/BankIdPasportPhoneEmail.json')}"></activiti:formProperty>
        
        <activiti:formProperty id="markersLine_2" name="Інформація про адресу заявника" type="markers" default="{&quot;attributes&quot;:{&quot;Line_2&quot;:{&quot;aElement_ID&quot;:[&quot;asPoselType&quot;],&quot;sValue&quot;:&quot;Інформація про адресу заявника&quot;}}}"></activiti:formProperty>
        <activiti:formProperty id="asPoselType" name="Тип наcеленого пункту" type="enum" required="true">
          <activiti:value id="sEnamMisto" name="місто"></activiti:value>
          <activiti:value id="sEnamSMT" name="селище міського типу (смт)"></activiti:value>
          <activiti:value id="sEnamCelo" name="сільский населений пункт (село)"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="sPoselName" name="Назва населеного пункту" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="asBudType" name="Вкажіть тип вашого будинку" type="enum" required="true">
          <activiti:value id="sBagkvatur" name="багатоквартирний"></activiti:value>
          <activiti:value id="sPrivSector" name="приватний"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="asTypeVul" name="Тип вулиці" type="enum" required="true">
          <activiti:value id="sEnamVul" name="вулиця"></activiti:value>
          <activiti:value id="sEnamProv" name="провулок"></activiti:value>
          <activiti:value id="sEnamProsp" name="проспект"></activiti:value>
          <activiti:value id="sEnamBulv" name="бульвар"></activiti:value>
          <activiti:value id="sEnamNaber" name="набережна"></activiti:value>
          <activiti:value id="sEnamUzviz" name="узвіз"></activiti:value>
          <activiti:value id="sEnamTupik" name="тупик"></activiti:value>
          <activiti:value id="sEnamStanc" name="станція"></activiti:value>
          <activiti:value id="sEnamSose" name="шосе"></activiti:value>
          <activiti:value id="sEnamPlosh" name="площа"></activiti:value>
          <activiti:value id="sEnamGM" name="жилий масив"></activiti:value>
          <activiti:value id="sEnamProy" name="проїзд"></activiti:value>
          <activiti:value id="sEnamSpusk" name="спуск"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="sRegistrationVul" name="Назва вулиці" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="sRegistrationBud" name="Номер будинку" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="asKorp" name="Чи поділено ваш будинок на корпуса?" type="enum" required="true">
          <activiti:value id="yes" name="так"></activiti:value>
          <activiti:value id="no" name="ні"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="lRegistrationKorp" name="Номер корпусу" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="asKvart" name="Чи поділено ваш будинок на квартири?" type="enum" required="true">
          <activiti:value id="yes" name="так"></activiti:value>
          <activiti:value id="no" name="ні"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="lRegistrationKvart" name="Номер квартири" type="string" required="true"></activiti:formProperty>
        <activiti:formProperty id="markerZutlo" name="markerFiles" type="markers" default="${markerService.loadFromFile('Rada/Rada_0274_zutlo.json')}"></activiti:formProperty>
        
        <activiti:formProperty id="markersLine_3" name="Інформація про звернення" type="markers" default="{&quot;attributes&quot;:{&quot;Line_3&quot;:{&quot;aElement_ID&quot;:[&quot;sPosada&quot;],&quot;sValue&quot;:&quot;Інформація про звернення&quot;}}}"></activiti:formProperty>
        <activiti:formProperty id="sPosada" name="До кого саме Ви маєте намір записатись на прийом" type="enum" required="true"></activiti:formProperty>
        <activiti:formProperty id="sPosadaName" name="Посада; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="sLabelHerson" name="Зони відповідальності у Херсонському МВК" type="label" default="можна переглянути за &lt;a href=&quot;https://docs.google.com/document/d/1z6oUvwWnzqacgJbfZn3-ogh9f-KwcmvnH-2-LwEnkB0/edit?usp=sharing&quot; target=&quot;_blank&quot;&gt;посиланням&lt;/a&gt;"></activiti:formProperty>
        <activiti:formProperty id="sRozkladPriyom" name="Розклад прийому" type="label" default=" "></activiti:formProperty>
        <activiti:formProperty id="visitDay" name="Вкажіть день, у який Ви бажаєте записатись на прийом" type="date" required="true"></activiti:formProperty>
        <activiti:formProperty id="sMessageText" name="Стислий зміст питання;(опишіть проблему максимально коротко)" type="fileHTML" required="true"></activiti:formProperty>
        
        <activiti:formProperty id="markerPosadaName" name="markerPosadaName" type="markers" default="${markerService.loadFromFile('Rada/Rada_0274_PosadaName.json')}"></activiti:formProperty>
        <activiti:formProperty id="markers" name="markers_herson" type="markers" default="${markerService.loadFromFile('ternopol_oda_226_herson.json')}"></activiti:formProperty>
        
        <activiti:formProperty id="ScriptAdress" name="назва органу ; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="sNameOrgan" name="назва органу ; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="sMailClerk226" name="електронна пошта; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="sPhoneOrgan" name="телефон для довідок ; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="sAddress" name="Адреса органу; ;bVisible=false" type="string"></activiti:formProperty>
      </extensionElements>
    </startEvent>
    <scriptTask id="scripttask1" name="Скріпт таска" scriptFormat="javascript" activiti:autoStoreVariables="false">
      <script>
var Misto = execution.getVariable('sPoselName')
var TipeVul = ' '
var Vul = execution.getVariable('sRegistrationVul')
var Bud = execution.getVariable('sRegistrationBud')
var Korp = execution.getVariable('lRegistrationKorp')
var Kvart = execution.getVariable('lRegistrationKvart')
var Adres = ' ' 

if(execution.getVariable('asTypeVul') == 'sEnamVul'){TipeVul = 'вулиця'}
if(execution.getVariable('asTypeVul') == 'sEnamProv'){TipeVul = 'провулок'}
if(execution.getVariable('asTypeVul') == 'sEnamProsp'){TipeVul = 'проспект'}
if(execution.getVariable('asTypeVul') == 'sEnamBulv'){TipeVul = 'бульвар'}
if(execution.getVariable('asTypeVul') == 'sEnamNaber'){TipeVul = 'набережна'}
if(execution.getVariable('asTypeVul') == 'sEnamUzviz'){TipeVul = 'узвіз'}
if(execution.getVariable('asTypeVul') == 'sEnamTupik'){TipeVul = 'тупик'}
if(execution.getVariable('asTypeVul') == 'sEnamStanc'){TipeVul = 'станція'}
if(execution.getVariable('asTypeVul') == 'sEnamSose'){TipeVul = 'шосе'}
if(execution.getVariable('asTypeVul') == 'sEnamPlosh'){TipeVul = 'площа'}
if(execution.getVariable('asTypeVul') == 'sEnamGM'){TipeVul = 'жилий масив'}
if(execution.getVariable('asTypeVul') == 'sEnamProy'){TipeVul = 'проїзд'}
if(execution.getVariable('asTypeVul') == 'sEnamSpusk'){TipeVul = 'спуск'}

if(execution.getVariable('asBudType') == 'sBagkvatur')
  {
  if(execution.getVariable('asKorp') == 'yes'){Adres = Misto+', '+TipeVul+' '+Vul+', б. '+Bud+', корп. '+Korp+', кв. '+Kvart}
  if(execution.getVariable('asKorp') == 'no'){Adres = Misto+', '+TipeVul+' '+Vul+', б. '+Bud+', кв. '+Kvart}
  }
if(execution.getVariable('asBudType') == 'sPrivSector')
  {
  if(execution.getVariable('asKvart') == 'yes'){Adres = Misto+', '+TipeVul+' '+Vul+', б. '+Bud+', кв. '+Kvart}
  if(execution.getVariable('asKvart') == 'no'){Adres = Misto+', '+TipeVul+' '+Vul+', б. '+Bud}
  }  
execution.setVariable('ScriptAdress', Adres)
      </script>
    </scriptTask>
    
    <serviceTask id="servicetask5" name="Лист-привітання громадянина" activiti:delegateExpression="#{MailTaskWithAttachmentsAndSMS}">
      <extensionElements>
        <activiti:field name="from">
          <activiti:string><![CDATA[noreply@igov.gov.ua]]></activiti:string>
        </activiti:field>
        <activiti:field name="to">
          <activiti:expression><![CDATA[${email}]]></activiti:expression>
        </activiti:field>
        <activiti:field name="subject">
          <activiti:expression><![CDATA[Звернення на тему: Запис на прийом до посадовця.]]></activiti:expression>
        </activiti:field>
        <activiti:field name="text">
          <activiti:expression><![CDATA[[pattern/mail/new_design/_common_header.html]
[pattern/mail/new_design/_common_content_start.html]
<p>Ваше звернення щодо запису на прийом успішно зареєстроване.<br>
Ви отримаєте відповідь протягом 1-3 робочих днів.</p>
<p>${sPhoneOrgan}</p>
[pattern/mail/new_design/_common_content_end.html]
[pattern/mail/new_design/_common_signature_start.html]
${sNameOrgan},<br>
[pattern/mail/new_design/_common_signature_end.html]
[pattern/mail/new_design/_common_footer.html]]]></activiti:expression>
        </activiti:field>
        <activiti:field name="sPhone_SMS">
          <activiti:expression><![CDATA[${phone}]]></activiti:expression>
        </activiti:field>
        <activiti:field name="sText_SMS">
          <activiti:expression><![CDATA[Vashe zvernennya [sID_Order] zareestrovano]]></activiti:expression>
        </activiti:field>
        <activiti:field name="saAttachmentsForSend">
          <activiti:expression><![CDATA[" "]]></activiti:expression>
        </activiti:field>
      </extensionElements>
    </serviceTask>
    <sequenceFlow id="flow16" sourceRef="servicetask5" targetRef="usertask1"></sequenceFlow>
    <serviceTask id="servicetask6" name="Повідомлення держслужбовця" activiti:delegateExpression="#{MailTaskWithoutAttachment}">
      <extensionElements>
        <activiti:field name="from">
          <activiti:string><![CDATA[noreply@igov.gov.ua]]></activiti:string>
        </activiti:field>
        <activiti:field name="to">
          <activiti:expression><![CDATA[${sMailClerk226}]]></activiti:expression>
        </activiti:field>
        <activiti:field name="subject">
          <activiti:expression><![CDATA[Нове звернення на тему: Запис на прийом до посадовця.]]></activiti:expression>
        </activiti:field>
        <activiti:field name="text">
          <activiti:expression><![CDATA[[pattern/mail/new_design/_common_employee_notify.html]]]></activiti:expression>
        </activiti:field>
      </extensionElements>
    </serviceTask>
    <sequenceFlow id="flow17" sourceRef="servicetask6" targetRef="servicetask5"></sequenceFlow>
    <userTask id="usertask1" name="Перевірка даних" activiti:candidateGroups="priyom_${sID_Public_SubjectOrganJoin}">
      <extensionElements>
        <activiti:formProperty id="clFIO" name="Прізвище, ім`я, по батькові громадянина" type="string" default="${bankIdlastName} ${bankIdfirstName} ${bankIdmiddleName}" writable="false"></activiti:formProperty>
        <activiti:formProperty id="bankIdinn" name="IПН" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="tPassport" name="Паспортні дані; ;writable=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="phone" name="Телефон громадянина" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="email" name="e-mail громадянина" type="string" writable="false"></activiti:formProperty>
        
        <activiti:formProperty id="markersLine_2" name="Інформація про житло" type="markers" default="{&quot;attributes&quot;:{&quot;Line_2&quot;:{&quot;aElement_ID&quot;:[&quot;asBudType&quot;],&quot;sValue&quot;:&quot;Інформація про житло&quot;}}}"></activiti:formProperty>
        <activiti:formProperty id="asPoselType" name="Тип наcеленого пункту" type="enum" writable="false">
          <activiti:value id="sEnamMisto" name="місто"></activiti:value>
          <activiti:value id="sEnamSMT" name="селище міського типу (смт)"></activiti:value>
          <activiti:value id="sEnamCelo" name="сільский населений пункт (село)"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="sPoselName" name="Назва населеного пункту; ;writable=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="asBudType" name="Тип будинку" type="enum" writable="false">
          <activiti:value id="sBagkvatur" name="багатоквартирний"></activiti:value>
          <activiti:value id="sPrivSector" name="приватний"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="asTypeVul" name="Тип вулиці" type="enum" writable="false">
          <activiti:value id="sEnamVul" name="вулиця"></activiti:value>
          <activiti:value id="sEnamProv" name="провулок"></activiti:value>
          <activiti:value id="sEnamProsp" name="проспект"></activiti:value>
          <activiti:value id="sEnamBulv" name="бульвар"></activiti:value>
          <activiti:value id="sEnamNaber" name="набережна"></activiti:value>
          <activiti:value id="sEnamUzviz" name="узвіз"></activiti:value>
          <activiti:value id="sEnamTupik" name="тупик"></activiti:value>
          <activiti:value id="sEnamStanc" name="станція"></activiti:value>
          <activiti:value id="sEnamSose" name="шосе"></activiti:value>
          <activiti:value id="sEnamPlosh" name="площа"></activiti:value>
          <activiti:value id="sEnamGM" name="жилий масив"></activiti:value>
          <activiti:value id="sEnamProy" name="проїзд"></activiti:value>
          <activiti:value id="sEnamSpusk" name="спуск"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="sRegistrationVul" name="Назва вулиці; ;writable=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="sRegistrationBud" name="Номер будинку; ;writable=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="asKorp" name="Чи поділено будинок на корпуса?" type="enum" writable="false">
          <activiti:value id="yes" name="так"></activiti:value>
          <activiti:value id="no" name="ні"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="lRegistrationKorp" name="Номер корпусу; ;writable=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="asKvart" name="Чи поділено будинок на квартири?" type="enum" writable="false">
          <activiti:value id="yes" name="так"></activiti:value>
          <activiti:value id="no" name="ні"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="lRegistrationKvart" name="Номер квартири; ;writable=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="markerZutlo" name="markerFiles" type="markers" default="${markerService.loadFromFile('Rada/Rada_0274_zutlo.json')}"></activiti:formProperty>
        
        <activiti:formProperty id="markersLine_33" name="Інформація про звернення" type="markers" default="{&quot;attributes&quot;:{&quot;Line_33&quot;:{&quot;aElement_ID&quot;:[&quot;sPosadaName&quot;],&quot;sValue&quot;:&quot;Інформація про звернення&quot;}}}"></activiti:formProperty>
        <activiti:formProperty id="sPosadaName" name="До кого заявник має намір записатись на прийом" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="visitDay" name="Бажаний день прийому" type="date" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sMessageText" name="Стислий зміст питання; ;writable=false" type="fileHTML"></activiti:formProperty>
        
        <activiti:formProperty id="asRisheniaj" name="Рішення про прийняття або відхилення заяви" type="enum" required="true">
          <activiti:value id="sEnumAccept" name="Записати громадянина"></activiti:value>
          <activiti:value id="sEnumReject" name="Скасувати запис"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="visitDay1" name="Призначений день прийому" type="date"></activiti:formProperty>
        <activiti:formProperty id="NumbPers" name="Номер особи в черзі" type="string"></activiti:formProperty>
        <activiti:formProperty id="tComment" name="Коментар державного службовця" type="textArea" default=" "></activiti:formProperty>
        <activiti:formProperty id="tCommentVidm" name="Вкажіть причину відмови" type="textArea" default=" "></activiti:formProperty>
        <activiti:formProperty id="markerDash" name="markerDash" type="markers" default="${markerService.loadFromFile('Rada/Rada_0274_Dash.json')}"></activiti:formProperty>
        
        <activiti:formProperty id="ScriptAdress" name="назва органу ; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="sNameOrgan" name="назва органу ; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="sBody_1" name="[pattern/print/rada/Rada_0274_Zvernenia.html]; ;bVisible=false ,bPrintform=true" type="string" default="Звернення" writable="false"></activiti:formProperty>
      </extensionElements>
    </userTask>
    <sequenceFlow id="flow2" sourceRef="usertask1" targetRef="exclusivegateway1"></sequenceFlow>
    <exclusiveGateway id="exclusivegateway1" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow3" name="Відмова" sourceRef="exclusivegateway1" targetRef="servicetask4">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${asRisheniaj=='sEnumReject'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow4" name="Запрошення" sourceRef="exclusivegateway1" targetRef="servicetask3">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${asRisheniaj=='sEnumAccept'}]]></conditionExpression>
    </sequenceFlow>
    <serviceTask id="servicetask4" name="Відмова" activiti:delegateExpression="#{MailTaskWithAttachmentsAndSMS}">
      <extensionElements>
        <activiti:field name="from">
          <activiti:string><![CDATA[noreply@igov.gov.ua]]></activiti:string>
        </activiti:field>
        <activiti:field name="to">
          <activiti:expression><![CDATA[${email}]]></activiti:expression>
        </activiti:field>
        <activiti:field name="subject">
          <activiti:expression><![CDATA[Звернення на тему: Запис на прийом до посадовця. Відмова.]]></activiti:expression>
        </activiti:field>
        <activiti:field name="text">
          <activiti:expression><![CDATA[[pattern/mail/new_design/_common_header.html]
[pattern/mail/new_design/_common_content_start.html]
<p>
<p>Ваше звернення щодо запису на прийом було відхилено.</p>
<p>Причина у наступному:<br> ${tCommentVidm}</p>
За необхідності Ви можете подати ще одну заяву на порталі <a href="https://igov.gov.ua/" target="_blank">igov.gov.ua</a>
</p>
[pattern/mail/new_design/_common_content_end.html]
[pattern/mail/new_design/_common_signature_start.html]
${sNameOrgan},<br>
[pattern/mail/new_design/_common_signature_end.html]
[pattern/mail/new_design/_common_footer.html]]]></activiti:expression>
        </activiti:field>
        <activiti:field name="sPhone_SMS">
          <activiti:expression><![CDATA[${phone}]]></activiti:expression>
        </activiti:field>
        <activiti:field name="sText_SMS">
          <activiti:expression><![CDATA[Za Vashym zvernennyam  [sID_Order]  vyneseno vidmovu v nadanni poslugy. Detali: igov.gov.ua/journal abo u Vashomu email]]></activiti:expression>
        </activiti:field>
        <activiti:field name="saAttachmentsForSend">
          <activiti:expression><![CDATA[" "]]></activiti:expression>
        </activiti:field>
      </extensionElements>
    </serviceTask>
    <endEvent id="endevent2" name="End"></endEvent>
    <serviceTask id="servicetask3" name="Лист з запрошенням" activiti:delegateExpression="#{MailTaskWithAttachmentsAndSMS}">
      <extensionElements>
        <activiti:field name="from">
          <activiti:string><![CDATA[noreply@igov.gov.ua]]></activiti:string>
        </activiti:field>
        <activiti:field name="to">
          <activiti:expression><![CDATA[${email}]]></activiti:expression>
        </activiti:field>
        <activiti:field name="subject">
          <activiti:expression><![CDATA[Звернення на тему: Запис на прийом до посадовця.]]></activiti:expression>
        </activiti:field>
        <activiti:field name="text">
          <activiti:expression><![CDATA[[[pattern/mail/new_design/_common_header.html]
[pattern/mail/new_design/_common_content_start.html]
<p>Ваше звернення щодо запису на прийом розглянуте.<br>
День прийому:<br>
value{[visitDay1]}<br>
Місце в черзі - ${NumbPers}</p>

<p>Коментар державного службовця (за наявністю):<br> ${tComment}</p>
<p>${sPhoneOrgan}</p>
[pattern/mail/new_design/_common_content_end.html]
[pattern/mail/new_design/_common_signature_start.html]
${sNameOrgan},<br>
[pattern/mail/new_design/_common_signature_end.html]
[pattern/mail/new_design/_common_footer.html]]]></activiti:expression>
        </activiti:field>
        <activiti:field name="sPhone_SMS">
          <activiti:expression><![CDATA[${phone}]]></activiti:expression>
        </activiti:field>
        <activiti:field name="sText_SMS">
          <activiti:expression><![CDATA[Vashe zvernennya [sID_Order] obrobleno. Detali: igov.gov.ua/journal abo u Vashomu email]]></activiti:expression>
        </activiti:field>
        <activiti:field name="saAttachmentsForSend">
          <activiti:expression><![CDATA[" "]]></activiti:expression>
        </activiti:field>
      </extensionElements>
    </serviceTask>
    <sequenceFlow id="flow12" sourceRef="servicetask3" targetRef="usertask2"></sequenceFlow>
    <userTask id="usertask2" name="Візит громадянина" activiti:candidateGroups="priyom_${sID_Public_SubjectOrganJoin}">
      <extensionElements>
        <activiti:formProperty id="visitDay1" name="День прийому" type="date" writable="false"></activiti:formProperty>
        <activiti:formProperty id="NumbPers" name="Номер особи в черзі" type="string" writable="false"></activiti:formProperty>
        
        <activiti:formProperty id="clFIO" name="Прізвище, ім`я, по батькові громадянина" type="string" default="${bankIdlastName} ${bankIdfirstName} ${bankIdmiddleName}" writable="false"></activiti:formProperty>
        <activiti:formProperty id="bankIdinn" name="IПН" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="tPassport" name="Паспортні дані; ;writable=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="phone" name="Телефон громадянина" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="email" name="e-mail громадянина" type="string" writable="false"></activiti:formProperty>
        
        <activiti:formProperty id="markersLine_2" name="Інформація про житло" type="markers" default="{&quot;attributes&quot;:{&quot;Line_2&quot;:{&quot;aElement_ID&quot;:[&quot;asBudType&quot;],&quot;sValue&quot;:&quot;Інформація про житло&quot;}}}"></activiti:formProperty>
        <activiti:formProperty id="asPoselType" name="Тип наcеленого пункту" type="enum" writable="false">
          <activiti:value id="sEnamMisto" name="місто"></activiti:value>
          <activiti:value id="sEnamSMT" name="селище міського типу (смт)"></activiti:value>
          <activiti:value id="sEnamCelo" name="сільский населений пункт (село)"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="sPoselName" name="Назва населеного пункту; ;writable=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="asBudType" name="Тип будинку" type="enum" writable="false">
          <activiti:value id="sBagkvatur" name="багатоквартирний"></activiti:value>
          <activiti:value id="sPrivSector" name="приватний"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="asTypeVul" name="Тип вулиці" type="enum" writable="false">
          <activiti:value id="sEnamVul" name="вулиця"></activiti:value>
          <activiti:value id="sEnamProv" name="провулок"></activiti:value>
          <activiti:value id="sEnamProsp" name="проспект"></activiti:value>
          <activiti:value id="sEnamBulv" name="бульвар"></activiti:value>
          <activiti:value id="sEnamNaber" name="набережна"></activiti:value>
          <activiti:value id="sEnamUzviz" name="узвіз"></activiti:value>
          <activiti:value id="sEnamTupik" name="тупик"></activiti:value>
          <activiti:value id="sEnamStanc" name="станція"></activiti:value>
          <activiti:value id="sEnamSose" name="шосе"></activiti:value>
          <activiti:value id="sEnamPlosh" name="площа"></activiti:value>
          <activiti:value id="sEnamGM" name="жилий масив"></activiti:value>
          <activiti:value id="sEnamProy" name="проїзд"></activiti:value>
          <activiti:value id="sEnamSpusk" name="спуск"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="sRegistrationVul" name="Назва вулиці; ;writable=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="sRegistrationBud" name="Номер будинку; ;writable=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="asKorp" name="Чи поділено будинок на корпуса?" type="enum" writable="false">
          <activiti:value id="yes" name="так"></activiti:value>
          <activiti:value id="no" name="ні"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="lRegistrationKorp" name="Номер корпусу; ;writable=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="asKvart" name="Чи поділено будинок на квартири?" type="enum" writable="false">
          <activiti:value id="yes" name="так"></activiti:value>
          <activiti:value id="no" name="ні"></activiti:value>
        </activiti:formProperty>
        <activiti:formProperty id="lRegistrationKvart" name="Номер квартири; ;writable=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="markerZutlo" name="markerFiles" type="markers" default="${markerService.loadFromFile('Rada/Rada_0274_zutlo.json')}"></activiti:formProperty>
        
        <activiti:formProperty id="markersLine_33" name="Інформація про звернення" type="markers" default="{&quot;attributes&quot;:{&quot;Line_33&quot;:{&quot;aElement_ID&quot;:[&quot;sPosadaName&quot;],&quot;sValue&quot;:&quot;Інформація про звернення&quot;}}}"></activiti:formProperty>
        <activiti:formProperty id="sPosadaName" name="До кого заявник має намір записатись на прийом" type="string" writable="false"></activiti:formProperty>
        <activiti:formProperty id="visitDay" name="Бажаний день прийому" type="date" writable="false"></activiti:formProperty>
        <activiti:formProperty id="sMessageText" name="Стислий зміст питання; ;writable=false" type="fileHTML"></activiti:formProperty>
        
        <activiti:formProperty id="vizit" name="Результат розгляду" type="enum" required="true">
          <activiti:value id="ok" name="Вирішено позитивно"></activiti:value>
          <activiti:value id="ok1" name="Надано роз’яснення"></activiti:value>
          <activiti:value id="nejav2" name="Відмовлено"></activiti:value>
          <activiti:value id="nejav" name="Громадянин не з'явився"></activiti:value>
        </activiti:formProperty>
        
        <activiti:formProperty id="ScriptAdress" name="назва органу ; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="sNameOrgan" name="назва органу ; ;bVisible=false" type="string"></activiti:formProperty>
        <activiti:formProperty id="sBody_1" name="[pattern/print/rada/Rada_0274_Zvernenia.html]; ;bVisible=false ,bPrintform=true" type="string" default="Звернення" writable="false"></activiti:formProperty>
      </extensionElements>
    </userTask>
    <sequenceFlow id="flow19" sourceRef="usertask2" targetRef="exclusivegateway2"></sequenceFlow>
    <exclusiveGateway id="exclusivegateway2" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow20" name="Фідбек" sourceRef="exclusivegateway2" targetRef="servicetask8">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${vizit!='nejav'}]]></conditionExpression>
    </sequenceFlow>
    <serviceTask id="servicetask8" name="Фідбек" activiti:delegateExpression="#{MailTaskWithoutAttachment}">
      <extensionElements>
        <activiti:field name="to">
          <activiti:expression><![CDATA[${email}]]></activiti:expression>
        </activiti:field>
        <activiti:field name="from">
          <activiti:string><![CDATA[noreply@igov.gov.ua]]></activiti:string>
        </activiti:field>
        <activiti:field name="subject">
          <activiti:expression><![CDATA[Звернення на тему: Запис на прийом до посадовця.]]></activiti:expression>
        </activiti:field>
        <activiti:field name="text">
          <activiti:expression><![CDATA[[pattern/mail/new_design/_common_header.html]
[pattern/mail/new_design/_common_content_start.html]
<p>Ви отримали послугу "Запис на прийом до посадовця".<br>
Будь ласка, оцініть якість надання цієї послуги за допомогою форми нижче.<br>
Дякуємо.</p>
[pattern/mail/new_design/_common_content_end.html]
[pattern/mail/new_design/_common_feedback.html]
[pattern/mail/new_design/_common_signature_start.html]
${sNameOrgan}<br>           
[pattern/mail/new_design/_common_signature_end.html]  
[pattern/mail/new_design/_common_footer.html]]]></activiti:expression>
        </activiti:field>
      </extensionElements>
    </serviceTask>
    <sequenceFlow id="flow22" sourceRef="servicetask8" targetRef="endevent3"></sequenceFlow>
    <endEvent id="endevent3" name="End"></endEvent>
    <sequenceFlow id="flow21" name="Неявка" sourceRef="exclusivegateway2" targetRef="servicetask9">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${vizit=='nejav'}]]></conditionExpression>
    </sequenceFlow>
    <serviceTask id="servicetask9" name="Е-мейл неявка" activiti:delegateExpression="#{MailTaskWithAttachmentsAndSMS}">
      <extensionElements>
        <activiti:field name="to">
          <activiti:expression><![CDATA[${email}]]></activiti:expression>
        </activiti:field>
        <activiti:field name="from">
          <activiti:string><![CDATA[noreply@igov.gov.ua]]></activiti:string>
        </activiti:field>
        <activiti:field name="subject">
          <activiti:expression><![CDATA[Звернення на тему: Запис на прийом до посадовця.]]></activiti:expression>
        </activiti:field>
        <activiti:field name="text">
          <activiti:expression><![CDATA[[pattern/mail/new_design/_common_header.html]
[pattern/mail/new_design/_common_content_start.html]
<p>На жаль, Ви не з'явились на прийом у призначений день і час.<br>
При необхідності нового запису Ви можете подати ще одну заявку на порталі <a href="https://igov.gov.ua/">igov.gov.ua</a></p>
[pattern/mail/new_design/_common_content_end.html]
[pattern/mail/new_design/_common_signature_start.html]
${sNameOrgan},<br>
[pattern/mail/new_design/_common_signature_end.html]
[pattern/mail/new_design/_common_footer.html]]]></activiti:expression>
        </activiti:field>
        <activiti:field name="sPhone_SMS">
          <activiti:expression><![CDATA[${phone}]]></activiti:expression>
        </activiti:field>
        <activiti:field name="sText_SMS">
          <activiti:expression><![CDATA[Na zhal', Vy ne z'iavylys' na pryiom u pryznachenyi den'. Vy mozhete podaty sche odnu zaiavku na portali https://igov.gov.ua]]></activiti:expression>
        </activiti:field>
        <activiti:field name="saAttachmentsForSend">
          <activiti:expression><![CDATA[" "]]></activiti:expression>
        </activiti:field>
      </extensionElements>
    </serviceTask>
    <sequenceFlow id="flow25" sourceRef="servicetask4" targetRef="endevent2"></sequenceFlow>
    <sequenceFlow id="flow27" sourceRef="servicetask9" targetRef="endevent3"></sequenceFlow>
    <sequenceFlow id="flow28" sourceRef="scripttask1" targetRef="servicetask6"></sequenceFlow>
    <sequenceFlow id="flow29" sourceRef="startevent1" targetRef="scripttask1"></sequenceFlow>
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_Rada_0274_ZapusPosadov">
    <bpmndi:BPMNPlane bpmnElement="Rada_0274_ZapusPosadov" id="BPMNPlane_Rada_0274_ZapusPosadov">
      <bpmndi:BPMNShape bpmnElement="startevent1" id="BPMNShape_startevent1">
        <omgdc:Bounds height="35.0" width="35.0" x="40.0" y="152.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="servicetask5" id="BPMNShape_servicetask5">
        <omgdc:Bounds height="61.0" width="105.0" x="367.0" y="138.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="servicetask6" id="BPMNShape_servicetask6">
        <omgdc:Bounds height="61.0" width="105.0" x="224.0" y="138.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="usertask1" id="BPMNShape_usertask1">
        <omgdc:Bounds height="61.0" width="105.0" x="506.0" y="138.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway1" id="BPMNShape_exclusivegateway1">
        <omgdc:Bounds height="40.0" width="40.0" x="538.0" y="240.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="servicetask4" id="BPMNShape_servicetask4">
        <omgdc:Bounds height="57.0" width="105.0" x="402.0" y="232.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent2" id="BPMNShape_endevent2">
        <omgdc:Bounds height="35.0" width="35.0" x="339.0" y="243.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="servicetask3" id="BPMNShape_servicetask3">
        <omgdc:Bounds height="59.0" width="105.0" x="610.0" y="231.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="usertask2" id="BPMNShape_usertask2">
        <omgdc:Bounds height="58.0" width="105.0" x="506.0" y="309.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway2" id="BPMNShape_exclusivegateway2">
        <omgdc:Bounds height="40.0" width="40.0" x="538.0" y="392.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="servicetask8" id="BPMNShape_servicetask8">
        <omgdc:Bounds height="61.0" width="105.0" x="610.0" y="382.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent3" id="BPMNShape_endevent3">
        <omgdc:Bounds height="35.0" width="35.0" x="541.0" y="459.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="servicetask9" id="BPMNShape_servicetask9">
        <omgdc:Bounds height="61.0" width="105.0" x="402.0" y="379.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="scripttask1" id="BPMNShape_scripttask1">
        <omgdc:Bounds height="55.0" width="105.0" x="99.0" y="141.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="flow16" id="BPMNEdge_flow16">
        <omgdi:waypoint x="472.0" y="168.0"></omgdi:waypoint>
        <omgdi:waypoint x="506.0" y="168.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow17" id="BPMNEdge_flow17">
        <omgdi:waypoint x="329.0" y="168.0"></omgdi:waypoint>
        <omgdi:waypoint x="367.0" y="168.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow2" id="BPMNEdge_flow2">
        <omgdi:waypoint x="558.0" y="199.0"></omgdi:waypoint>
        <omgdi:waypoint x="558.0" y="240.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow3" id="BPMNEdge_flow3">
        <omgdi:waypoint x="538.0" y="260.0"></omgdi:waypoint>
        <omgdi:waypoint x="507.0" y="260.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14.0" width="42.0" x="408.0" y="219.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow4" id="BPMNEdge_flow4">
        <omgdi:waypoint x="578.0" y="260.0"></omgdi:waypoint>
        <omgdi:waypoint x="610.0" y="260.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14.0" width="63.0" x="612.0" y="219.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow12" id="BPMNEdge_flow12">
        <omgdi:waypoint x="662.0" y="290.0"></omgdi:waypoint>
        <omgdi:waypoint x="558.0" y="309.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow19" id="BPMNEdge_flow19">
        <omgdi:waypoint x="558.0" y="367.0"></omgdi:waypoint>
        <omgdi:waypoint x="558.0" y="392.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow20" id="BPMNEdge_flow20">
        <omgdi:waypoint x="578.0" y="412.0"></omgdi:waypoint>
        <omgdi:waypoint x="610.0" y="412.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14.0" width="33.0" x="612.0" y="368.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow22" id="BPMNEdge_flow22">
        <omgdi:waypoint x="662.0" y="443.0"></omgdi:waypoint>
        <omgdi:waypoint x="558.0" y="459.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow21" id="BPMNEdge_flow21">
        <omgdi:waypoint x="538.0" y="412.0"></omgdi:waypoint>
        <omgdi:waypoint x="507.0" y="409.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14.0" width="37.0" x="406.0" y="369.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow25" id="BPMNEdge_flow25">
        <omgdi:waypoint x="402.0" y="260.0"></omgdi:waypoint>
        <omgdi:waypoint x="374.0" y="260.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow27" id="BPMNEdge_flow27">
        <omgdi:waypoint x="454.0" y="440.0"></omgdi:waypoint>
        <omgdi:waypoint x="558.0" y="459.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow28" id="BPMNEdge_flow28">
        <omgdi:waypoint x="204.0" y="168.0"></omgdi:waypoint>
        <omgdi:waypoint x="224.0" y="168.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow29" id="BPMNEdge_flow29">
        <omgdi:waypoint x="75.0" y="169.0"></omgdi:waypoint>
        <omgdi:waypoint x="99.0" y="168.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>